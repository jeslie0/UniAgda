#+title: Suspensions
#+author: James Leslie
#+STARTUP: noindent hideblocks latexpreview
* Prelude
#+begin_src agda2
{-# OPTIONS --without-K --rewriting #-}
module UniAgda.HITs.Suspensions where


open import UniAgda.Core.Types.Universes
open import UniAgda.Core.Types.Functions
open import UniAgda.Core.Types.Identity
open import UniAgda.Core.Types.Sigma
open import UniAgda.Core.Types.Nat
open import UniAgda.Core.Types.Bool

open import UniAgda.Core.Homotopy
open import UniAgda.Core.Equivalences

open import UniAgda.Core.PathAlgebra
open import UniAgda.Core.PathSpaces.Identity
open import UniAgda.HITs.Core public
open import UniAgda.HITs.Circle public

postulate
  Susp : {i : Level} (A : Type i) â†’ Type i
  N : {i : Level} {A : Type i} â†’ Susp A
  S : {i : Level} {A : Type i} â†’ Susp A
  merid : {i : Level} {A : Type i}
          â†’ A â†’ N {i} {A} â‰¡ S {i} {A}

  Susp-rec : {i j : Level} {A : Type i} {B : Type j}
             â†’ (n s : B) â†’ (m : A â†’ n â‰¡ s)
             â†’ Susp A â†’ B

  Î²Susp-recN : {i j : Level} {A : Type i} {B : Type j}
              â†’ (n s : B) â†’ (m : A â†’ n â‰¡ s)
              â†’ Susp-rec n s m N â†¦ n

  Î²Susp-recS : {i j : Level} {A : Type i} {B : Type j}
              â†’ (n s : B) â†’ (m : A â†’ n â‰¡ s)
              â†’ Susp-rec n s m S â†¦ s

{-# REWRITE Î²Susp-recN #-}
{-# REWRITE Î²Susp-recS #-}

postulate
  Î²Susp-rec-merid : {i j : Level} {A : Type i} {B : Type j}
                    â†’ (n s : B) â†’ (m : A â†’ n â‰¡ s) â†’ (a : A)
                    â†’ ap (Susp-rec n s m) (merid a) â‰¡ m a

postulate
  Susp-ind : {i j : Level} {A : Type i} {P : Susp A â†’ Type j}
             (n : P N) (s : P S) (m : (a : A) â†’ transport P (merid a) n â‰¡ s)
             â†’ (x : Susp A) â†’ P x

  Î²Susp-ind-N : {i j : Level} {A : Type i} {P : Susp A â†’ Type j}
                (n : P N) (s : P S) (m : (a : A) â†’ transport P (merid a) n â‰¡ s)
                â†’ Susp-ind n s m N â†¦ n

  Î²Susp-ind-S : {i j : Level} {A : Type i} {P : Susp A â†’ Type j}
                (n : P N) (s : P S) (m : (a : A) â†’ transport P (merid a) n â‰¡ s)
                â†’ Susp-ind n s m S â†¦ s

{-# REWRITE Î²Susp-ind-N #-}
{-# REWRITE Î²Susp-ind-S #-}

postulate
  Î²Susp-ind-merid : {i j : Level} {A : Type i} {P : Susp A â†’ Type j}
                    (n : P N) (s : P S) (m : (a : A) â†’ transport P (merid a) n â‰¡ s) (a : A)
                    â†’ apD (Susp-ind n s m) (merid a) â†¦  m a


ğ•Š : â„• â†’ Type lzero
ğ•Š zero = Bool
ğ•Š (suc zero) = SÂ¹
ğ•Š (suc (suc n)) = Susp (ğ•Š (suc n))



{- Properties -}

SÂ¹-to-Susp-Bool : SÂ¹ â†’ Susp Bool
SÂ¹-to-Susp-Bool =  SÂ¹-rec {_} {Susp Bool} N (merid (false) âˆ˜ merid (true) ^)

private
  mâ‚ : Bool â†’ base â‰¡ base
  mâ‚ true = refl
  mâ‚ false = loop

Susp-Bool-to-SÂ¹ : Susp Bool â†’ SÂ¹
Susp-Bool-to-SÂ¹ = Susp-rec {_} {_} {Bool} {SÂ¹} base base mâ‚

private
  Susp-Bool-eqv-SÂ¹-homâ‚-lemmaâ‚ : ap Susp-Bool-to-SÂ¹ (merid false) â‰¡ loop
  Susp-Bool-eqv-SÂ¹-homâ‚-lemmaâ‚ = Î²Susp-rec-merid {_} {_} {Bool} {SÂ¹} base base mâ‚ false

  Susp-Bool-eqv-SÂ¹-homâ‚-lemmaâ‚‚ : ap SÂ¹-to-Susp-Bool loop â‰¡ merid false âˆ˜ merid true ^
  Susp-Bool-eqv-SÂ¹-homâ‚-lemmaâ‚‚ = Î²SÂ¹-rec-loop {_} {Susp Bool} N (merid false âˆ˜ merid true ^)

  Susp-Bool-eqv-SÂ¹-homâ‚-lemmaâ‚ƒ : ap Susp-Bool-to-SÂ¹ (merid true) â‰¡ refl
  Susp-Bool-eqv-SÂ¹-homâ‚-lemmaâ‚ƒ = Î²Susp-rec-merid {_} {_} {Bool} {SÂ¹} base base mâ‚ true


Susp-Bool-eqv-SÂ¹-homâ‚ : SÂ¹-to-Susp-Bool o Susp-Bool-to-SÂ¹ ~ id
Susp-Bool-eqv-SÂ¹-homâ‚ x =
  let g = SÂ¹-to-Susp-Bool
      f = Susp-Bool-to-SÂ¹
  in Susp-ind {_} {_} {Bool} {Î» x â†’ (SÂ¹-to-Susp-Bool o Susp-Bool-to-SÂ¹) x â‰¡ id x} refl
  (merid true)
  (Î» { true â†’ thm2-11-3 (g o f) id (merid true) refl âˆ˜
    ap (Î» p â†’ p ^ âˆ˜ (ap id (merid true))) (ap-gf g f (merid true)) âˆ˜
    (transport (Î» p â†’ ap g p ^ âˆ˜ ap id (merid true) â‰¡ merid true) (Susp-Bool-eqv-SÂ¹-homâ‚-lemmaâ‚ƒ ^))
    (ap-id (merid true))  ;
  false â†’  thm2-11-3 (g o f) (id) (merid false) refl âˆ˜
    ap (Î» p â†’ p ^ âˆ˜ ap id (merid false)) (ap-gf g f (merid false)) âˆ˜
    transport (Î» p â†’ ap SÂ¹-to-Susp-Bool (p) ^ âˆ˜ ap id (merid false) â‰¡ merid true) (Susp-Bool-eqv-SÂ¹-homâ‚-lemmaâ‚ ^)
    (transport (Î» p â†’ p ^ âˆ˜ ap id (merid false) â‰¡ merid true) (Susp-Bool-eqv-SÂ¹-homâ‚-lemmaâ‚‚ ^)
    ( ap (Î» p â†’ p âˆ˜ ap id (merid false)) (pq-^-to-q^p^ (merid false) (merid true ^)) âˆ˜
    ass-l (merid true ^ ^) (merid false ^) (ap id (merid false)) âˆ˜ p^^q-to-pq (merid true) (merid false ^ âˆ˜ ap id (merid false)) âˆ˜ ap (Î» p â†’ merid true âˆ˜ p) (p^-apIDp-to-refl (merid false)) âˆ˜ p-refl (merid true))) }) x

private
  Susp-Bool-eqv-SÂ¹-homâ‚‚-lemmaâ‚ : ap SÂ¹-to-Susp-Bool loop â‰¡ merid false âˆ˜ merid true ^
  Susp-Bool-eqv-SÂ¹-homâ‚‚-lemmaâ‚ = Î²SÂ¹-rec-loop N (merid false âˆ˜ merid true ^)


Susp-Bool-eqv-SÂ¹-homâ‚‚ : Susp-Bool-to-SÂ¹ o SÂ¹-to-Susp-Bool ~ id
Susp-Bool-eqv-SÂ¹-homâ‚‚ x =
  let g = SÂ¹-to-Susp-Bool
      f = Susp-Bool-to-SÂ¹
  in  SÂ¹-ind {_} {Î» x â†’ (Susp-Bool-to-SÂ¹ o SÂ¹-to-Susp-Bool) x â‰¡ id x} refl
    (thm2-11-3 (f o g) id loop refl âˆ˜ transport (Î» p â†’ p ^ âˆ˜ ap id loop â‰¡ refl) (ap-gf f g loop ^)
    (transport (Î» p â†’ ap Susp-Bool-to-SÂ¹ p ^ âˆ˜ ap id loop â‰¡ refl) (Susp-Bool-eqv-SÂ¹-homâ‚‚-lemmaâ‚ ^)
    (transport (Î» p â†’ p ^ âˆ˜ ap id loop â‰¡ refl) (apf-pq f (merid false) (merid true ^) ^)
    (transport (Î» p â†’ (p âˆ˜ ap Susp-Bool-to-SÂ¹ (merid true ^)) ^ âˆ˜ ap id loop â‰¡ refl) (Susp-Bool-eqv-SÂ¹-homâ‚-lemmaâ‚ ^)
    (transport (Î» p â†’ (loop âˆ˜ p) ^ âˆ˜ ap id loop â‰¡ refl) (apf-p^ f (merid true) ^)
    (transport (Î» p â†’ (loop âˆ˜ p ^) ^ âˆ˜ ap id loop â‰¡ refl) ( Susp-Bool-eqv-SÂ¹-homâ‚-lemmaâ‚ƒ ^)
    (transport (Î» p â†’ p ^ âˆ˜ ap id loop â‰¡ refl) (p-refl loop ^)
    (transport (Î» p â†’ loop ^ âˆ˜ p â‰¡ refl) (ap-id loop ^) (p^p loop))))))))) x


Susp-Bool-eqv-SÂ¹ : Susp Bool â‰ƒ SÂ¹
Susp-Bool-eqv-SÂ¹ = equiv-adjointify (Susp-Bool-to-SÂ¹ , (SÂ¹-to-Susp-Bool , Susp-Bool-eqv-SÂ¹-homâ‚‚ , Susp-Bool-eqv-SÂ¹-homâ‚))
lemma6-5-1 = Susp-Bool-eqv-SÂ¹
#+end_src
